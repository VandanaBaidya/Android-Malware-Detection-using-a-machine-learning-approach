from rawpermissions import benignname_len,finalname_len,benignperm_len,finalperm_len, benignperm_list
#print "\n\n\n\n"
d={}

	
#print "Length --------------------------------------------", len(mylist)

count = 0

with open('benignpermissions.txt') as b:
	line=b.readline()
	while line:
		count += 1
		#print "Count = ", count
		words=line.split(":")
		first_word=words[0]
		if(first_word=='package'):
			finalword=words[1][:-2]
			#print "finalword = ", finalword
			d[finalword] = [0 for i in range(finalperm_len+1)]
			for k in range(finalperm_len):
				d[finalword][k]=0
			d[finalword][finalperm_len]=0
			line=b.readline()
			words=line.split(":")
			first_word=words[0]
			
			#print "First word = ", first_word
			while(line and first_word!="package"):
				#print "Entered while"
				if(first_word=='uses-permission' or first_word=='optional-permission'):
					split1 = words[1].split('=')
					split1=str(split1)
					split2 = split1.split('.')
					final_perm =split2[-1][:-5]
				else:
					perm1=line.split(".")
					final_perm=str(perm1[-1:])
					final_perm = final_perm[2:-4]
				for j in range(finalperm_len):
					#print "Entered FOR"
					if(final_perm==benignperm_list[j]):
						index=benignperm_list.index(final_perm)
						d[finalword][index]=1
				line=b.readline()
				words=line.split(":")
				first_word=words[0]
				
			
			
	line=b.readline()
#print(d)
with open('malwarepermissions.txt') as m:
	line=m.readline()
	while line:
		#count += 1
		#print "Count = ", count
		words=line.split(":")
		first_word=words[0]
		if(first_word=='package'):
			finalword=words[1][:-2]
			#print "finalword = ", finalword
			d[finalword] = [0 for i in range(finalperm_len+1)]
			for k in range(finalperm_len):
				d[finalword][k]=0
			d[finalword][finalperm_len]=1
			line=m.readline()
			words=line.split(":")
			first_word=words[0]
			#print "First word = ", first_word
			while(line and first_word!="package"):
				#print "Entered while"
				if(first_word=='uses-permission' or first_word=='optional-permission'):
					split1 = words[1].split('=')
					split1=str(split1)
					split2 = split1.split('.')
					final_perm =split2[-1][:-5]
				else:
					perm1=line.split(".")
					final_perm=str(perm1[-1:])
					final_perm = final_perm[2:-4]
				for j in range(finalperm_len):
					#print "Entered FOR"
					if(final_perm==benignperm_list[j]):
						index=benignperm_list.index(final_perm)
						d[finalword][index]=1
				line=m.readline()
				words=line.split(":")
				first_word=words[0]
				
	line=m.readline()		
#print(d)
			

