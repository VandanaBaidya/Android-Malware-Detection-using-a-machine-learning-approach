#!/usr/bin/python


#extracting the list of names and permissions of malicious files
with open('malwarepermissions.csv') as f:
	line=f.readline()
	malname_list=list()
	malperm_list=list()
	while line:
		#count+=1
		words=line.split(":")
		first_word=words[0]
		if(first_word=='package'):
			finalword=words[1][:-2]
			malname_list.append(finalword)
			
		elif(first_word=='uses-permission' or first_word=='optional-permission'):
			a = words[1].split('=')
			a=str(a)
			b = a.split('.')
			final_perm =b[-1][:-5]
			print final_perm
			if not final_perm in malperm_list:
				malperm_list.append(final_perm)
		else:
			perm1=line.split(".")
			final_perm1=str(perm1[-1:])
			final_perm1 = final_perm1[2:-4]
			if not final_perm1 in malperm_list:
				malperm_list.append(final_perm1)
		line=f.readline()
	'''	
	print "\n\n\n\n\n"
	print "Names = ", malname_list
	print "\n\n\n\n\n"
	print "Perms = ", malperm_list
	print "\n\n\n\n\n"
	'''
	malname_len=len(malname_list)
	malperm_len=len(malperm_list)
	#print(malname_len)
	#print(malperm_len)
	#print(malname_list)
	#print(malperm_list)
	


#extracting the list of names and permissions of benign files
with open('benignpermissions.csv') as f:
	line=f.readline()
	benignname_list=list()
	benignperm_list=list()
	while line:
		#count+=1
		words=line.split(":")
		first_word=words[0]
		if(first_word=='package'):
			finalword=words[1][:-2]
			benignname_list.append(finalword)
			
		elif(first_word=='uses-permission' or first_word=='optional-permission'):
			a = words[1].split('=')
			a=str(a)
			b = a.split('.')
			final_perm =b[-1][:-5]
			#print final_perm
			if not final_perm in benignperm_list:
				benignperm_list.append(final_perm)
		else:
			perm1=line.split(".")
			final_perm1=str(perm1[-1:])
			final_perm1 = final_perm1[2:-4]
			if not final_perm1 in benignperm_list:
				benignperm_list.append(final_perm1)
		line=f.readline()
	'''	
	print "\n\n\n\n\n"
	print "Names = ", benignname_list
	print "\n\n\n\n\n"
	print "Perms = ", benignperm_list
	print "\n\n\n\n\n"
	'''
	benignname_len=len(benignname_list)
	benignperm_len=len(benignperm_list)
	
	#print(benignname_len)
	#print(benignperm_len)
	#print(benignname_list)
	#print(benignperm_list)
	
#combining the list of names and permissions

for i in range(len(malname_list)):
	Name=malname_list[i]
	benignname_list.append(Name)
#print(len(benignname_list))
for i in range(len(malperm_list)):
	Perm=malperm_list[i]
	if Perm not in benignperm_list:
		benignperm_list.append(Perm)
#print(len(benignperm_list))
finalname_len=len(benignname_list)
finalperm_len=len(benignperm_list)		

