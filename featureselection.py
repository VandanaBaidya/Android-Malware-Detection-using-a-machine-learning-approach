import pandas
import numpy as np
from sklearn.feature_selection import SelectKBest
from sklearn.feature_selection import chi2
from sklearn.svm import SVC
from sklearn.metrics import accuracy_score
from sklearn import svm
from sklearn.model_selection import train_test_split
from sklearn.model_selection import cross_val_score
from binary import finalperm_len

#feature ranking and extraction for train data
range1= [i for i in range(1,finalperm_len+1)]
df_train = pandas.read_csv('output1.csv',usecols=range1)
array_train = df_train.values

X = array_train[np.arange(len(array_train))!=-1] #samples
Y = array_train[:,-1] #target (class labels)
test1 = SelectKBest(score_func=chi2, k=100) #score function can be changed. 
fit1 = test1.fit(X, Y)

np.set_printoptions(precision=3)
features = fit1.transform(X) #top 100 features obtained
df = pandas.DataFrame(np.array(features))
df.to_csv('finalfeat.csv')





